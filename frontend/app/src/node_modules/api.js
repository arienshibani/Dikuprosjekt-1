import fetch from "node-fetch";

export async function getResponses(ids) {
    //Takes in an array of IDs and returns the feedbacks associated with them.
    try {
        const resp = await fetch("api/feedback", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(ids)
        });
        console.log(resp)
        return await resp.json();
    } catch (err) {
        console.log(err);
        return [];
    }
}

export async function getFeedback() {
    try {
        const resp = await fetch("api/question_feedback", {
            method: "GET"
        })
        const json = await resp.json();

        return json
    } catch (err) {
        console.log(err);
    }
}

export async function postData(data) {
    try {
        fetch("api/data", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
        });
    } catch (err) {
        console.log(`Data post failed ${err}`);
    }
}

export async function getUserData(username) {
    try {
        const resp = await fetch("api/userdata", {
            method: "GET"
        })
        const json = await resp.json();

        for (let i = 0; i < json.length; i++) {

            if (json[i]["user"] === username) {
                return json[i];
            }
        }

        return false;

    } catch (err) {
        console.log(err);
    }
}

export async function updateUserData(data) {
    try {
        fetch("api/userdata", {
            method: "PUT",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
        });
    } catch (err) {
        console.log(`UserData update failed ${err}`);
    }
}
/*
export async function postNewUser(username) {
    try {
        let data = {"user": username,
        "results": {}
        };
        fetch("api/data", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(data)
        });
    } catch (err) {
        console.log(`Posting new user failed ${err}`);
    }
} */

export async function postNewUser(data) {
    try {
        fetch("api/userdata", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify(data)
        });
    } catch (err) {
        console.error(`Userdata post failed ${err}`);
    }
}
